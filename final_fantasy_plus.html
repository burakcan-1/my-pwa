<!doctype html>
<html lang="en">
<head>
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2ba84a">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="icons/icon-192.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Fantasy Animal Prompt â€” Plus</title>
  <style>
    :root{
      --bg:#f7f7f7; --card:#fff; --text:#111; --muted:#666; --primary:#2ba84a; --border:#dcdcdc;
    }
    *{box-sizing:border-box}
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 16px; background: var(--bg); color:var(--text); }
    h1 { font-size: 1.35rem; margin: 0 0 8px; }
    .grid { display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
    .field, fieldset { background: var(--card); border:1px solid var(--border); border-radius:12px; padding:12px; }
    label { display:block; font-size: 0.95rem; margin-bottom: 6px; }
    input[type="text"], select, input[type="number"] { width: 100%; padding: 10px; font-size: 1rem; border-radius: 8px; border: 1px solid var(--border); background: #fff; }
    .row { display:flex; gap:8px; }
    .row > * { flex:1 }
    button { border: none; background: var(--primary); color: #fff; font-weight: 700; margin-top: 12px; padding:10px 14px; border-radius:10px; cursor:pointer; }
    button.secondary { background: #555; }
    #prompt { white-space: pre-wrap; background: #222; color: #eee; padding: 12px; border-radius: 8px; margin-top: 12px; min-height: 56px; }
    small { color:var(--muted); }
    fieldset legend { padding:0 6px; font-weight:700; }
    .inline { display:flex; flex-wrap:wrap; gap:8px; }
    .inline label { display:inline-flex; align-items:center; gap:6px; margin:0; padding:6px 8px; border:1px solid var(--border); border-radius:999px; background:#fafafa; }
    details { margin-top:12px; }
    .actions { display:flex; gap:8px; flex-wrap:wrap; }
    .muted { color:var(--muted) }
  </style>
</head>
<body>
  <h1>Fantasy Animal Builder â€” Plus</h1>
  <small>Tip: open this file in Safari/Chrome (not in an email preview) so buttons work.</small>

  <!-- (All your existing input fields and fieldsets remain unchanged) -->

  <!-- ACTION BUTTONS -->
  <div class="actions">
    <button id="buildBtn" type="button">Get the Prompt</button>
    <button id="copyBtn" class="secondary" type="button">Copy Prompt</button>
    <button id="resetBtn" class="secondary" type="button">Reset</button>
    <button id="surpriseBtn" class="secondary" type="button">Surprise me</button>
  </div>

  <div id="prompt" aria-live="polite">Your prompt will appear hereâ€¦</div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const $ = (id) => document.getElementById(id);

      function randomName() {
        const parts1 = ["Glow","Fluff","Storm","Shadow","Crystal","Spark","Moon","Star","Leaf","Frost","Iron","Lava","Thunder","Aqua","Mirth","Echo","Cinder","Bramble"];
        const parts2 = ["horn","wing","tail","scale","puff","fang","beast","claw","mane","whisker","flame","shell","hoof","gleam"];
        return parts1[Math.floor(Math.random() * parts1.length)] + parts2[Math.floor(Math.random() * parts2.length)];
      }

      function checkedValues(containerId){
        return Array.from(document.querySelectorAll('#'+containerId+' input[type="checkbox"]:checked'))
          .map(cb => cb.value);
      }

      function sentence(list, conj="and"){
        if(!list || list.length===0) return "";
        if(list.length===1) return list[0];
        return list.slice(0,-1).join(", ") + " " + conj + " " + list[list.length-1];
      }

      function buildPrompt() {
        let name = $('name').value.trim() || randomName();
        const color = $('color').value.trim();
        const accent = $('accent').value.trim();
        const size = $('size').value;
        const age = $('age').value;
        const wings = $('wings').value;
        const horns = $('horns').value;
        const legs = $('legs').value;
        const tail = $('tail').value;
        const habitat = $('habitat').value;
        const personality = $('personality').value;
        const style = $('style').value;
        const pose = $('pose').value;
        const expression = $('expression').value;
        const time = $('time').value;
        const background = $('background').value.trim();
        const extras = $('extras').value.trim();
        const composition = $('composition').value;
        const camera = $('camera').value;
        const quality = $('quality').value;
        const negatives = $('negatives').value.trim();
        const patterns = checkedValues('patterns');
        const abilities = checkedValues('abilities');

        let prompt = `Create an illustration of a fantasy animal named "${name}". `;
        prompt += `It is a ${size} ${age} creature`;
        if (color) prompt += `, mainly ${color}`;
        if (accent) prompt += ` with ${accent}`;
        prompt += `. It has ${wings}, ${horns}, ${legs} legs, and ${tail}. `;
        if (patterns.length) prompt += `Its body features ${sentence(patterns)}. `;
        if (abilities.length) prompt += `It can ${sentence(abilities)}. `;
        prompt += `It lives in the ${habitat} and has a ${personality} personality. `;
        prompt += `Pose it ${pose} with a ${expression} expression at ${time}. `;
        if (background) prompt += `Background elements: ${background}. `;
        if (extras) prompt += `Accessories: ${extras}. `;
        prompt += `Draw it in ${style} style, using a ${composition}, from an ${camera}. `;
        prompt += `Rendering preference: ${quality}. `;
        if (negatives) prompt += `Avoid: ${negatives}.`;

        $('prompt').textContent = prompt;
      }

      function copyPrompt() {
        const text = $('prompt').textContent || '';
        if (!text) return;
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(text).then(() => alert('Prompt copied!'));
        } else {
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          document.execCommand('copy');
          document.body.removeChild(ta);
          alert('Prompt copied!');
        }
      }

      function resetAll(){
        document.querySelectorAll('input[type="text"]').forEach(i=>i.value="");
        document.querySelectorAll('select').forEach(s=>s.selectedIndex=0);
        document.querySelectorAll('input[type="checkbox"]').forEach(c=>c.checked=false);
        $('prompt').textContent = 'Your prompt will appear hereâ€¦';
      }

      // ðŸŽ² Surprise me button logic
      function surpriseMe(){
        $('prompt').textContent = 'Your prompt will appear hereâ€¦';
        const pick = (arr)=>arr[Math.floor(Math.random()*arr.length)];
        const chance = (p=0.5)=>Math.random()<p;

        const pools = {
          color:["blue","green","purple","golden","turquoise","silver","crimson","emerald"],
          accent:["neon highlights","glowing stripes","sparkling dots","metallic accents","rainbow tips"],
          size:["tiny","small","medium","large","giant"],
          age:["baby","young","adult","ancient"],
          wings:["no wings","feathered wings","bat wings","insect wings"],
          horns:["no horns","small horns","big curved horns","antlers"],
          legs:["2","4","6","8","no visible legs"],
          tail:["no tail","short tail","long tail","fluffy tail","spiked tail","fishtail"],
          habitat:["forest","sea","sky","mountains","desert","city","outer space"],
          personality:["friendly","curious","mischievous","brave","gentle","shy"],
          style:["cartoon","watercolor","pixel art","3D render","realistic","storybook illustration"],
          pose:["sitting","standing","walking","running","curled up"],
          expression:["smiling","playful","sleepy","curious","proud"],
          time:["daylight","golden hour","twilight","night with soft glow"],
          background:["ancient ruins","floating island","starry sky","crystal cave","mystic forest","waterfall"],
          extras:["scarf","tiny backpack","bracelet","leaf crown","rider saddle","gemstone necklace"],
          composition:["centered composition","rule of thirds composition","dynamic diagonal composition"],
          camera:["eye-level view","low-angle view for a heroic feel","top-down view","wide-angle perspective","macro close-up of details"],
          quality:["clean line work and simple shading","soft shading and gentle gradients","high detail with crisp edges","textured brushes for a painterly feel"],
          negatives:["no text","no watermark","no scary elements","no weapons","no gore","no cluttered background"]
        };

        const setVal=(id,val)=>{const el=$(id); if(el) el.value=val;};
        setVal('name', randomName());
        Object.keys(pools).forEach(k=>setVal(k,pick(pools[k])));

        // Randomize checkboxes
        const randomizeChecks=(id,prob=0.35)=>{
          document.querySelectorAll('#'+id+' input[type="checkbox"]').forEach(cb=>cb.checked=Math.random()<prob);
        };
        randomizeChecks('patterns',0.45);
        randomizeChecks('abilities',0.4);

        // Build prompt
        buildPrompt();
      }

      $('buildBtn').addEventListener('click', buildPrompt, false);
      $('copyBtn').addEventListener('click', copyPrompt, false);
      $('resetBtn').addEventListener('click', resetAll, false);
      $('surpriseBtn').addEventListener('click', surpriseMe, false);
    });
  </script>

  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js');
    });
  }
  </script>
</body>
</html>